h = tx.data[0] // Leaf hash.
i = 1
while i < msg.datasize:
    x = msg.data[i]
    if x % 2 == 0:  // Combine with left/right hash.
        h = sha3(h + x - x % 2)
    else:
        h = sha3(x - x % 2 + h)
    i += 1

return(h)
